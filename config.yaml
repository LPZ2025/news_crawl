# ===== NewsNow 平台配置 =====
# 只需要 id 和 name，会自动使用 newsnow API
newsnow_platforms:
  - id: "cls"
    name: "财联社电报"
  - id: "cls-depth"
    name: "财联社深度"
  - id: "cls-hot"
    name: "财联社热门"
  - id: "wallstreetcn-hot"
    name: "华尔街见闻最热"
  - id: "wallstreetcn-news"
    name: "华尔街见闻最新"
  - id: "wallstreetcn-quick"
    name: "华尔街见闻快讯"
  - id: "fastbull-express"
    name: "法布财经快讯"
  - id: "fastbull-news"
    name: "法布财经头条"
  - id: "gelonghui"
    name: "格隆汇"
  - id: "jin10"
    name: "金十数据"
  - id: "zaobao"
    name: "联合早报"
  - id: "thepaper"
    name: "澎湃新闻"
  - id: "toutiao"
    name: "今日头条"
  - id: "weibo"
    name: "微博"
  - id: "ifeng"
    name: "凤凰网"
  - id: "bilibili-hot-search"
    name: "bilibili 热搜"
  - id: "baidu"
    name: "百度热搜"
  - id: "zhihu"
    name: "知乎"

# ===== 自定义 API 平台配置 =====
# 所有配置都在这里，代码中不再硬编码
custom_platforms:
  - id: "36kr"
    name: "36氪"
    api_url: "https://v2.xxapi.cn/api/hot36kr"
    
    # HTTP 请求配置
    request:
      method: "GET"  # GET 或 POST
      timeout: 10    # 超时时间（秒）
      # headers 可选，不配置则使用默认值
      # headers:
      #   User-Agent: "Mozilla/5.0..."
      #   Accept: "application/json"
    
    # 重试配置
    retry:
      max_retries: 2      # 最大重试次数
      min_retry_wait: 3   # 最小等待时间（秒）
      max_retry_wait: 5   # 最大等待时间（秒）
    
    # 数据解析配置
    data_parsing:
      data_path: "data"  # 数据列表路径（支持嵌套路径，如 "data.items"）
      fallback_enabled: true  # 是否启用 fallback（当 data_path 找不到数据时）
      fallback_fields: ["data", "list", "items", "result"]  # fallback 字段列表
    
    # 字段映射（支持嵌套路径，如 "templateMaterial.widgetTitle"）
    field_mapping:
      title: "templateMaterial.widgetTitle"      # 标题字段
      publishTime: "templateMaterial.publishTime"  # 发布时间字段
      itemId: "templateMaterial.itemId"          # 用于构建URL的ID字段
    
    # URL 构建配置
    url_builder:
      base_url: "https://36kr.com/p/"  # URL基础地址
      template: "{base_url}/{itemId}"  # URL 模板，支持 {base_url} 和 {itemId} 占位符
    
    # 调试配置
    debug:
      enabled: false  # 是否启用调试信息（打印详细的数据结构）

# ===== 新闻清洗和评分配置 =====
news_cleaning:
  # 相似度去重阈值（0-1）
  similarity_threshold: 0.88
  
  # 硅基流动API配置
  api:
    url: "https://api.siliconflow.cn"  # 硅基流动API地址
    api_key: "sk-sxpyjtcowumppjqojdvmznxwnajlbdthkgetinouskcmafln"  # 请在此处填写你的API Key
    model: "Qwen/Qwen2.5-7B-Instruct"  # 模型名称（格式：命名空间/模型名）
    timeout: 30  # 请求超时时间（秒）
    max_retries: 3  # 最大重试次数
    retry_delay: 1  # 重试延迟（秒）
    request_delay: 0.1  # 请求间隔延迟（秒），减少此值可提高速度
    # 模型参数
    temperature: 0.5  # 温度参数（0-2），越低越确定，默认0.5
    max_tokens: 1024  # 最大生成token数，默认1024
    top_p: 0.7  # 核采样参数（0-1），默认0.7
    frequency_penalty: 0.0  # 频率惩罚（-2.0到2.0），默认0.0
  
  # 批量处理配置
  batch_size: 20  # 每次批量处理的新闻数量
  
  # A股相关性评分Prompt（单条新闻用）
  prompt: |
    你是一名资深卖方分析师 + A股事件交易专家，熟悉A股盘面逻辑、政策节奏、产业链、事件驱动模式和短线资金风格。

    你将收到一条新闻标题，请严格按照"两层过滤 + 多维度打分"机制输出结构化 JSON。

    ========================================
    【第一层过滤：A股潜在相关性判断（极度宽松）】
    ========================================

    判断这条新闻是否"有可能"对A股产生直接或间接影响。  

    只要满足以下任意条件，即视为"A股相关"（A股相关性=1），可进入第二层评分。

    满足任意以下条件 → A股相关性 = 1：

    1. 【商业 & 消费 & 娱乐 & 文旅】

       - 影视票房、爆款电影、明星商业活动、演唱会、旅游热度、消费趋势、IP经济

       - 可能影响：传媒、电影、消费、旅游、酒店、主题乐园、文旅IP

    2. 【科技 / 汽车 / 能源 / 制造】

       - 科技产品发布、汽车销量、电子产品、AI、芯片、新能源车、机器人、航天等

       - 涉及中概或海外科技巨头也算（会传导到A股科技板块）

    3. 【政策/监管/政府部门发声】

       - 国务院、部委政策、地方发布会、监管变化等

    4. 【产业链事件】

       - 供应链合作、量产时间点、涨价/降价、需求变化、订单信息、产业链扩张

    5. 【宏观或全球风险事件】

       - CPI、PMI、经济数据、地缘事件、油价、汇率、美股科技新闻

    6. 【热点情绪事件】

       - 网络热议、短剧爆款、流量激增、话题冲上热搜

       - 可能影响传媒/情绪周期、短线资金方向

    7. 【任何与上市公司可能存在联系的内容】

       - 包含品牌、产品、场景、消费方向、市场趋势

    只有以下类型新闻 → 才判定为 A股相关性=0：

    - 纯社会新闻（事故、纠纷、犯罪案件、家庭伦理）

    - 情感故事、鸡汤、职场八卦、校园趣事

    - 无商业属性的个人故事

    - 地方小范围民生/社区新闻

    - 美食/健身/生活方式内容

    - 体育新闻（除非涉及消费、赞助、大型赛事带动文旅）

    如果 A股相关性 = 0  

    请直接返回：

    {{
     "A股相关性": 0,
     "剔除理由": "..."
    }}

    并立即结束任务。

    ==================================================
    【第二层评分（仅在 A股相关性=1 时执行）】
    ==================================================

    请根据新闻内容进行结构化量化分析。严格按以下字段输出：

    {{
      "A股相关性": 1,
      "利好利空": "利好/利空/中性",
      "是否政策类": 0/1,
      "是否大厂事件": 0/1,   
      "是否产业链事件": 0/1,
      "是否提到具体板块": 0/1,
      "是否属于高概率发酵方向": 0/1,
      "是否具有明确时间节点": 0/1, 
      "是否具有明确催化点": 0/1,     // 新增：是否具备能引发交易的事件触发器
      "对A股影响力度评分": 1-10,     // 对次日市场的影响强度
      "事件级别评分": 1-10,          // 事件本身级别（普通/行业/板块/主线）
      "信息新鲜度评分": 1-10,         // 你根据常识判断新闻的"新旧程度"
      "是否可能引发连板炒作": 0/1,  // 基于现阶段A股情绪周期判断
      "主要影响板块": ["板块1","板块2",...],  // 尽量填写具体，如"光模块、医药商业、旅游酒店"
      "主要可能影响的方向": ["消费","AI","文旅","医疗","能源",...],
      "一句话理由": "一句说明核心逻辑"
    }}

    ========================================
    【要求】
    ========================================

    - 只输出 JSON，不要解释。

    - 若不能判断，尽量基于常识进行合理推断。

    - 若没有板块或方向，输出空列表 []。

    ========================================
    【新闻标题】
    ========================================

    {news_title}
  
  # 批量处理Prompt
  batch_prompt: |
    你是一名资深卖方分析师 + A股事件交易专家，熟悉A股盘面逻辑、政策节奏、产业链、事件驱动模式和短线资金风格。

    下面是一组新闻，请逐条给我输出 JSON 评分。

    对于每条新闻，请严格按照"两层过滤 + 多维度打分"机制输出结构化 JSON。

    ========================================
    【第一层过滤：A股潜在相关性判断（极度宽松）】
    ========================================

    判断这条新闻是否"有可能"对A股产生直接或间接影响。  

    只要满足以下任意条件，即视为"A股相关"（A股相关性=1），可进入第二层评分。

    满足任意以下条件 → A股相关性 = 1：

    1. 【商业 & 消费 & 娱乐 & 文旅】
       - 影视票房、爆款电影、明星商业活动、演唱会、旅游热度、消费趋势、IP经济
       - 可能影响：传媒、电影、消费、旅游、酒店、主题乐园、文旅IP

    2. 【科技 / 汽车 / 能源 / 制造】
       - 科技产品发布、汽车销量、电子产品、AI、芯片、新能源车、机器人、航天等
       - 涉及中概或海外科技巨头也算（会传导到A股科技板块）

    3. 【政策/监管/政府部门发声】
       - 国务院、部委政策、地方发布会、监管变化等

    4. 【产业链事件】
       - 供应链合作、量产时间点、涨价/降价、需求变化、订单信息、产业链扩张

    5. 【宏观或全球风险事件】
       - CPI、PMI、经济数据、地缘事件、油价、汇率、美股科技新闻

    6. 【热点情绪事件】
       - 网络热议、短剧爆款、流量激增、话题冲上热搜
       - 可能影响传媒/情绪周期、短线资金方向

    7. 【任何与上市公司可能存在联系的内容】
       - 包含品牌、产品、场景、消费方向、市场趋势

    只有以下类型新闻 → 才判定为 A股相关性=0：
    - 纯社会新闻（事故、纠纷、犯罪案件、家庭伦理）
    - 情感故事、鸡汤、职场八卦、校园趣事
    - 无商业属性的个人故事
    - 地方小范围民生/社区新闻
    - 美食/健身/生活方式内容
    - 体育新闻（除非涉及消费、赞助、大型赛事带动文旅）

    如果 A股相关性 = 0  
    请直接返回：
    {{
     "A股相关性": 0,
     "剔除理由": "..."
    }}

    并立即结束该条新闻的处理。

    ==================================================
    【第二层评分（仅在 A股相关性=1 时执行）】
    ==================================================

    请根据新闻内容进行结构化量化分析。严格按以下字段输出：

    {{
      "A股相关性": 1,
      "利好利空": "利好/利空/中性",
      "是否政策类": 0/1,
      "是否大厂事件": 0/1,   
      "是否产业链事件": 0/1,
      "是否提到具体板块": 0/1,
      "是否属于高概率发酵方向": 0/1,
      "是否具有明确时间节点": 0/1, 
      "是否具有明确催化点": 0/1,
      "对A股影响力度评分": 1-10,
      "事件级别评分": 1-10,
      "信息新鲜度评分": 1-10,
      "是否可能引发连板炒作": 0/1,
      "主要影响板块": ["板块1","板块2",...],
      "主要可能影响的方向": ["消费","AI","文旅","医疗","能源",...],
      "一句话理由": "一句说明核心逻辑"
    }}

    ========================================
    【要求】
    ========================================
    - 只输出 JSON 数组，每个元素对应一条新闻的评分结果
    - 输出格式：[{{"新闻标题": "...", "评分结果": {{...}}}}, {{"新闻标题": "...", "评分结果": {{...}}}}, ...]
    - 若不能判断，尽量基于常识进行合理推断
    - 若没有板块或方向，输出空列表 []

    ========================================
    【新闻列表】
    ========================================

    {news_titles}